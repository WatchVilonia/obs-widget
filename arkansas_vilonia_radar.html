<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Arkansas & Vilonia Weather Radar Animation</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
        }
        #map {
            width: 100%;
            height: 100%;
        }
    </style>
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
</head>
<body>
    <div id="map"></div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

    <script>
        // Initialize the map without zoom controls
        let map = L.map('map', {
            center: [35.0834, -92.2071],
            zoom: 8,
            zoomControl: false
        });

        // Base map layer from OpenStreetMap
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 12,
            attribution: '© OpenStreetMap contributors'
        }).addTo(map);

        // Predefined radar timestamps (Unix timestamps)
        let radarTimestamps = [
            '0',  // Latest radar image
            '-10', // 10 minutes ago
            '-20', // 20 minutes ago
            '-30', // 30 minutes ago
            '-40', // 40 minutes ago
            '-50', // 50 minutes ago
            '-60'  // 60 minutes ago
        ];

        // Index to keep track of the current radar frame
        let radarIndex = 0;

        // Function to update the radar layer
        function updateRadarLayer() {
            // Remove existing radar layer if it exists
            if (window.radarLayer) {
                map.removeLayer(window.radarLayer);
            }

            // Get the timestamp offset
            let timestamp = radarTimestamps[radarIndex];

            // Radar tile URL using the timestamp offset
            let radarLayerUrlTemplate = `https://tilecache.rainviewer.com/v2/radar/${timestamp}/256/{z}/{x}/{y}/1/1_1.png`;

            // Add new radar layer
            window.radarLayer = L.tileLayer(radarLayerUrlTemplate, {
                opacity: 0.6,
                attribution: 'Weather data © RainViewer'
            }).addTo(map);

            // Update index for next frame
            radarIndex = (radarIndex + 1) % radarTimestamps.length;
        }

        // Start the radar animation
        updateRadarLayer(); // Show the first frame immediately
        setInterval(updateRadarLayer, 500); // Change frame every 500 ms (adjust as needed)

        // Function to switch between Arkansas and Vilonia views
        function switchRadarView() {
            let currentCenter = map.getCenter();
            if (currentCenter.lat === 35.0834 && currentCenter.lng === -92.2071) {
                map.setView([35.0834, -92.1301], 11); // Vilonia view
            } else {
                map.setView([35.0834, -92.2071], 8); // Arkansas view
            }
        }

        // Cycle radar view every 30 seconds
        setInterval(switchRadarView, 30000);
    </script>
</body>
</html>
